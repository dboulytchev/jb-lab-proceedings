\section{Обсуждение и будущие направления работы}

Следующий этап исследования --- это поиск разрешимого, но всё ещё применимого на практике, фрагмента системы типов. Мы оставляем этот вопрос открытым.

Каким образом это может принести пользу? Нерасширяющиеся подтипирование, рассматриваемое в этой работе, адаптированно для .NET Framework. Чувствительный к путям анализ \dotnet-кода (например в смысле символьного исполнения) может натолкнуться на операторы приведения и проверки типа. Это приводит к появлению в условиях реализации пути бескванторных формул, отображающих ограничения на типовые параметры. Качество анализа довольно часто измеряется процентным соотношением ложных положительных результатов, которое можно уменьшить, устранив недостижимые пути исполнения. Так как \subtypesat{}, очевидно, полуразрешима, существует алгоритм, который доказывает выполнимость ограничений, но не существует алгоритма для доказательства их невыполнимости, другими словами, для доказательства недостижимости путей исполнения. В теории, нахождение практически применимого разрешимого фрагмента может привести к значительному улучшению анализа обобщенного объектно-ориентированного кода с учетом вариантностей. В частности, это касается функций F\#, скомпилированных в код, который широко использует обобщённые типы и вариантность.

Работа \cite{su2002first} показывает неразрешимость теории первого порядка ограничений на подтипирование для не структурного подтипирования. Это доказательство можно легко адаптировать для задачи \subtypesat{}, и это покажет её неразрешимость для таблиц классов с крайне непрактичными ограничениями. Однако доказательство из~\cite{su2002first} использует формулы первого порядка с кванторами всеобщности. Мы утверждаем, что для получения применимого на практике разрешимого фрагмента системы типов рассматриваемые формулы должны оставаться (по крайней мере) бескванторными.

Попытки построить разрешающую процедуру привели нас к тому, что, вероятно, основным свойством типов, которое может препятствовать разрешимости, является <<сложное>> устройство множества их надтипов. Например наше доказательство критически зависит от записей в таблице классов вида $\onector{\pcpuword{i}}{+\pcpxtype} \edge \overline{\pcpuword{i}}\xtype$ и $\pcprestalt \edge \pcpuword{1}\pcprestalt, \, \ldots, \, \pcpuword{n}\pcprestalt$, так как множество супертипов таких типов являются в точности конкатенациями слов из заданного множества. Примеры~\ref{exmp:subtype} и~\ref{exmp:not-coprime} демонстрируют, что даже с одним ковариантным конструктором могут быть выражены некоторые нетривиальные (хотя и не неразрешимые) задачи.

Ещё одним направлением для исследований является построение эффективной разрешающей процедуры для случая с бескванторными формулами. Мы сформулировали задачу \subtypesat{} в терминах задачи выполнимости по модулю теории, направленной на применение в SMT-решателях~\cite{barrett2018satisfiability,de2011satisfiability}.

Текущее определение \subtypesat{} допускает только интерпретации с закрытыми типами, сформированными из фиксированной таблицы классов. Но, на практике, модульные анализаторы не знают всей таблицы классов. С уточнением состояния контекста могут появиться новые записи в таблице классов. Например условие $\xtype \subtype A \land \xtype \subtype B$ может быть невыполнимо в фиксированной таблице классов, но динамически подгружаемые модули могут добавить новую запись $C \edge A,\, B$, и тип тогда $C$ будет удовлетворять ограничениям. Решение переформулированной \subtypesat{}, позволяющей расширять таблицу классов, даст возможность применять его для автоматической генерации тестов и эксплойтов. Естественным способом решения такой расширенной задачи является сведение \subtypesat{} к свободной теории, допускающей расширение домена.
